get_filename_component(_LCMS2_PREFIX_DIR "${CMAKE_CURRENT_LIST_FILE}" DIRECTORY)

include("${_LCMS2_PREFIX_DIR}/lcms2-targets.cmake")

set(LCMS2_LIBRARIES lcms2::lcms2)
set(LCMS2_LIBRARY   lcms2::lcms2)
get_target_property(LCMS2_INCLUDE_DIR lcms2::lcms2 INTERFACE_INCLUDE_DIRECTORIES)

file(READ ${LCMS2_INCLUDE_DIR}/lcms2.h LCMS2_VERSION_CONTENT)
string(REGEX MATCH "#define LCMS_VERSION[ ]*[0-9]*\n" LCMS2_VERSION_MATCH ${LCMS2_VERSION_CONTENT})
if(LCMS2_VERSION_MATCH)
    string(REGEX REPLACE "#define LCMS_VERSION[ ]*([0-9]*)\n" "\\1" LCMS2_VERSION ${LCMS2_VERSION_MATCH})
    if(NOT LCMS2_FIND_QUIETLY)
        string(SUBSTRING ${LCMS2_VERSION} 0 1 LCMS2_MAJOR_VERSION)
        string(SUBSTRING ${LCMS2_VERSION} 1 2 LCMS2_MINOR_VERSION)
        message(STATUS "Found lcms version ${LCMS2_MAJOR_VERSION}.${LCMS2_MINOR_VERSION}, ${LCMS2_LIBRARIES}, LCMS2_INCLUDE_DIR: ${LCMS2_INCLUDE_DIR}")
    endif(NOT LCMS2_FIND_QUIETLY)
else(LCMS2_VERSION_MATCH)
    if(NOT LCMS2_FIND_QUIETLY)
        message(STATUS "Found lcms2 but failed to find version ${LCMS2_LIBRARIES}")
    endif(NOT LCMS2_FIND_QUIETLY)
    set(LCMS2_VERSION NOTFOUND)
endif(LCMS2_VERSION_MATCH)

set(_LCMS2_PREFIX_DIR)
